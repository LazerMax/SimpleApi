Установите .NET 6:
https://learn.microsoft.com/en-us/dotnet/core/install/linux-scripted-manual#scripted-install

bash
# Удалите старый .deb-файл (если был)
sudo rm -f /etc/apt/sources.list.d/microsoft-prod.list

# Скачайте актуальный пакет
curl -L -o packages-microsoft-prod.deb https://packages.microsoft.com/config/ubuntu/$(lsb_release -rs)/packages-microsoft-prod.deb

# Установите репозиторий
sudo dpkg -i packages-microsoft-prod.deb
sudo apt update
sudo apt update
sudo apt install -y dotnet-sdk-9.0
Клонируйте проект:

Установка .Net v.2
curl -L https://dot.net/v1/dotnet-install.sh -o dotnet-install.sh
Перед запуском этого скрипта убедитесь, что вы предоставили разрешение на запуск этого скрипта в качестве исполняемого файла:
Копировать
chmod +x ./dotnet-install.sh
Скрипт по умолчанию устанавливает последнюю версию SDK с долгосрочной поддержкой (LTS) , то есть .NET 8. Чтобы установить последнюю версию, которая может не быть версией (LTS), используйте --version latestпараметр.
Чтобы установить .NET Runtime вместо SDK, используйте --runtimeпараметр.
./dotnet-install.sh --version latest --runtime aspnetcore
Вы можете установить определенную основную версию с --channelпараметром, указывающим конкретную версию. Следующая команда устанавливает .NET 9.0 SDK.
Копировать
./dotnet-install.sh --channel 9.0

bash
mkdir -p /home/$USER/app
cd /home/$USER/app
git clone https://github.com/ваш-логин/SimpleApi.git
Публикация проекта:

bash
cd SimpleApi
dotnet publish -c Release -o /var/www/app
sudo chmod 755 /var/www/app
4. Настройка systemd
Создайте файл /etc/systemd/system/simpleapi.service:

ini
[Unit]
Description=Simple API Service
After=network.target

[Service]
WorkingDirectory=/var/www/app
ExecStart=/usr/bin/dotnet /var/www/app/SimpleApi.dll --urls "http://*:5000"
Restart=always
User=www-data

[Install]
WantedBy=multi-user.target
Запустите службу:

bash
sudo systemctl enable simpleapi
sudo systemctl start simpleapi
5. Настройка Nginx
Установите Nginx:

bash
sudo apt install -y nginx
Создайте конфиг /etc/nginx/sites-available/simpleapi:

nginx
server {
    listen 80;
    server_name localhost;  # Или ваш IP/домен

    location /api/ {
        proxy_pass http://localhost:5000;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    location / {
        return 404;  # Базовый URL возвращает 404
    }
}

Активируйте и перезапустите:

bash
sudo ln -s /etc/nginx/sites-available/simpleapi /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl restart nginx
6. Проверка работы
На сервере:

bash
curl http://localhost/api/healthcheck
С Windows (в той же сети):

powershell
curl http://IP_СЕРВЕРА/api/healthcheck
7. История команд (для отчёта)
bash
history | grep -E "dotnet|nginx|systemctl|ufw|git"

sudo nano /etc/netplan/00-installer-config.yaml

network:
  ethernets:
    eth0:
      dhcp4: true
      dhcp6: true  # Оставляем IPv6
  version: 2


Вывод команд:
user@LMA:~/app/SimpleApi$ history | grep -E "dotnet|nginx|systemctl|ufw|git"
  114  dotnet nuget locals all --clear
  116  dotnet restore
  118  sudo systemctl enable simpleapi
  119  sudo systemctl start simpleapi
  120  sudo systemctl status simpleapi
  127  dotnet publish -c Release -o /var/www/app --runtime linux-x64
  131  dotnet clean
  133  dotnet publish -c Release -o /var/www/app --runtime linux-x64
  136  sudo systemctl daemon-reload
  137  sudo systemctl restart simpleapi
  138  sudo systemctl status simpleapi
  139  sudo apt install -y nginx
  140  sudo systemctl stop unattended-upgrades
  143  sudo apt install -y nginx
  144  sudo nano /etc/nginx/sites-available/simpleapi
  145  sudo ln -s /etc/nginx/sites-available/simpleapi /etc/nginx/sites-enabled/
  146  sudo nginx -t
  147  sudo systemctl restart nginx
  152  sudo nano /etc/nginx/sites-available/simpleapi
  154  sudo systemctl status nginx
  156  sudo nano /etc/nginx/sites-available/simpleapi
  157  sudo ln -s /etc/nginx/sites-available/simpleapi /etc/nginx/sites-enabled/
  158  sudo nginx -t
  159  sudo systemctl restart nginx
  160  sudo systemctl status nginx
  162  sudo nginx -t
  163  cat /etc/nginx/sites-enabled/simpleapi
  164  sudo nano /etc/nginx/sites-available/simpleapi
  165  sudo nginx -t
  166  sudo systemctl restart nginx
  169  sudo nginx -T | grep server
  170  ls -la /etc/nginx/sites-enabled/
  171  sudo rm /etc/nginx/sites-enabled/default
  172  sudo rm /etc/nginx/sites-enabled/simpleapi
  173  sudo rm /etc/nginx/sites-enabled/default
  174  sudo rm /etc/nginx/sites-enabled/simpleapi
  175  sudo nano /etc/nginx/sites-available/api
  176  sudo ln -s /etc/nginx/sites-available/api /etc/nginx/sites-enabled/
  177  sudo nginx -t && sudo systemctl restart nginx
  195  sudo ufw status
  196  sudo ufw allow 80/tcp
  197  sudo ufw allow 5000/tcp
  198  history | grep -E "dotnet|nginx|systemctl|ufw|git"
